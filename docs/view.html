<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View | Public Webpages | Section 508 Pro</title>
    <script src="assets/uswds/dist/js/uswds-init.min.js"></script>
    <link rel="stylesheet" href="assets/uswds/dist/css/uswds.min.css" />

    <script src="components/wcag-form/index.js"></script>

    <style>
      td{
        text-align: right;
      }

      th{
        font-weight: bold;
      }

      summary > h3 {
        display: inline-block;
      }

      summary > h4 {
        display: inline-block;
        text-indent: 2em;
      }

      summary > h5 {
        display: inline-block;
        text-indent: 4em;
      }

    </style>
    
    <script>
      window.addEventListener('load', init);

      function init(){
        const querystring = new URLSearchParams(document.location.search);
        let website = querystring.get("website");
        update(website); 
      }

      /**
       * Updates the page with new data
       */
      function update(website){
        reset();
        fetchData();
        let details = getDetails();
        
        let sidebarMenu = document.querySelector(`#${website}`);
        if(sidebarMenu){
          // 1. show current on agency sidebar nav
          sidebarMenu.classList.add("usa-current");
        
          // 2. change main header
          let header = document.querySelector("#main-header");
          header.innerHTML = sidebarMenu.innerHTML;

          // 3. load Lighthouse HTML report
          let lighthouseHtml = document.querySelector("#lighthouse-html");
          lighthouseHtml.src = details.get("htmlLighthouse");
        }else{
          console.error(`No website found for website=${website}`);
        }
      }

      /**
       * Resets the page to a new, empty state
       */
      function reset(){
        // 1. UNDO show current on agency sidebar nav
        let currents = document.querySelectorAll(".usa-current");
        if(currents){
          currents.forEach((current) => {
            current.classList.remove("usa-current");
          });
        }
        
        // 2. UNDO change main header
        let header = document.querySelector("#main-header");
        header.innerHTML = "";
      }

      /**
       * Fetches all data need to update the page
       */
      async function fetchData(){
        const details = getDetails();
        console.log(details);

        saveJson("jsonAllPages");
        saveJson("jsonErrorsSummaryLighthouse");
        saveJson("jsonErrorsSummaryWcag");
        saveJson("jsonLighthouse");
        saveJson("jsonA11y");
        saveJson("jsonA11yErrors");
      }

      /**
       * Returns parameters needed to update the data:
       *  - Agency ("cns")
       *  - Type ("mobile" | "desktop")
       *  - Date ("2023-08-31")
       *  - Page ("/about")
       */
      function getDetails(){
        let details = new Map();
        
        // agency
        const querystring = new URLSearchParams(document.location.search);
        let website = querystring.get("website");
        details.set("website", website);

        // type
        details.set("type", "mobile");

        // date
        details.set("date", "2023-08-08");

        // webpage
        details.set("webpage", "/");

        // baseUrl        
        details.set("baseUrl", `https://section508pro.github.io/508-${website}-data`);

        // dateUrl 
        details.set("dateUrl", `${details.get("baseUrl")}/reports/${details.get("type")}/${details.get("date")}`);
        
        // pageUrl
        details.set("pageUrl", `${details.get("dateUrl")}/reports${details.get("webpage")}`);

        // jsonAllPages
        details.set("jsonAllPages", `${details.get("dateUrl")}/ci-result.json`);

        // jsonErrorsSummaryLighthouse
        details.set("jsonErrorsSummaryLighthouse", `${details.get("dateUrl")}/errors-summary-lighthouse.json`);

        // jsonErrorsSummaryWcag
        details.set("jsonErrorsSummaryWcag", `${details.get("dateUrl")}/errors-summary-wcag.json`);

        // htmlLighthouse
        details.set("htmlLighthouse", `${details.get("pageUrl")}/lighthouse.html`);

        // jsonLighthouse
        details.set("jsonLighthouse", `${details.get("pageUrl")}/lighthouse.json`);

        // jsonA11y
        details.set("jsonA11y", `${details.get("pageUrl")}/a11y.json`);

        // jsonA11yErrors
        details.set("jsonA11yErrors", `${details.get("pageUrl")}/a11y-errors.json`);

        return details;
      }

      /**
       * Saves remote json to sessionStorage
       */ 
      async function saveJson(key){
        const details = getDetails();
        const response = await fetch(details.get(key));
        const json = await response.json();
        sessionStorage.setItem(key, JSON.stringify(json, null, 2));
      }

      /**
       * Returns WCAG SC (Success Criteria) for Lighthouse audit key
       * Example: "link-name": ["2.4.4", "4.1.2"]
       */ 
      function lh2wcag(lhKey){
        const rules = {
          // WCAG 2.0 A and AA
          //"aria-alt": ["1.1.1", "2.4.4", "4.1.2"],
          "aria-allowed-attr": ["4.1.2"],
          "aria-command-name": ["4.1.2"],
          "aria-hidden-body": ["4.1.2"],
          "aria-hidden-focus": ["1.3.1", "4.1.2"],
          "aria-input-field-name": ["4.1.2"],
          "aria-meter-name": ["1.1.1"],
          "aria-progressbar-name": ["1.1.1"],
          "aria-required-attr": ["4.1.2"],
          "aria-required-children": ["1.3.1"],
          "aria-required-parent": ["1.3.1"],
          //"aria-roledescription": ["4.1.2"],
          "aria-roles": ["4.1.2"],
          "aria-toggle-field-name": ["4.1.2"],
          "aria-tooltip-name": ["4.1.2"],
          "aria-valid-attr-value": ["4.1.2"],
          "aria-valid-attr": ["4.1.2"],
          //"audio-caption": ["1.2.1"],
          //"blink": ["2.2.2"],
          "button-name": ["4.1.2"],
          "bypass": ["2.4.1"],
          "color-contrast": ["1.4.3"],
          "definition-list": ["1.3.1"],
          //"dl-item": ["1.3.1"],
          "document-title": ["2.4.2"],
          "duplicate-id-active": ["4.1.1"],
          "duplicate-id-aria": ["4.1.1"],
          //"duplicate-id": ["4.1.1"],
          "form-field-multiple-labels": ["3.3.2"],
          //"frame-focusable-content": ["2.1.1"],
          "frame-title": ["2.4.1", "4.1.2"],
          "html-has-lang": ["3.1.1"],
          "html-lang-valid": ["3.1.1"],
          //"html-xml-lang-mismatch": ["3.1.1"],
          "image-alt": ["1.1.1"],
          //"input-button-name": ["4.1.2"],
          "input-image-alt": ["1.1.1"],
          "label": ["1.3.1", "4.1.2"],          
          "link-name": ["2.4.4", "4.1.2"],
          "list": ["1.3.1"],
          "listitem": ["1.3.1"],
          //"marquee": ["2.2.2"],
          "meta-refresh": ["2.2.1", "2.2.4", "3.2.5"],
          //"nested-interactive": ["4.1.2"],
          "object-alt": ["1.1.1"],
          //"role-img-alt": ["1.1.1"],
          //"scrollable-region-focusable": ["2.1.1"],
          //"select-name": ["1.3.1", "4.1.2"],
          //"server-side-image-map": ["2.1.1"],
          //"svg-img-alt": ["1.1.1"],
          "td-headers-attr": ["1.3.1"],
          //"td-has-data-cells": ["1.3.1"],
          "valid-lang": ["3.1.2"],
          "video-caption": ["1.2.2"]
          // WCAG 2.1 A and AA
          //"autocomplete-valid": ["1.3.5"],
          //"avoid-inline-spacing": ["1.4.1"],
          //"empty-table-header": ["1.3.1"],
          // WCAG 2.0 and 2.1 AAA
          //"color-contrast-enhanced": ["1.4.6"],
          //"identical-links-same-purpose": ["2.4.9"],
          // AXE Experimental
          //"css-orientation-lock": ["1.3.4"],
          //"label-content-name-mismatch": ["2.5.3"],
          //"link-in-text-block": ["1.4.1"],
          //"no-autoplay-audio": ["1.4.2"],
          //"p-as-heading": ["1.3.1"],
          //"table-fake-caption": ["1.3.1"],
          //"td-has-header": ["1.3.1"]
        };
        
        return rules[lhKey];
      }


    </script>
  </head>
  <body>
  <a class="usa-skipnav" href="#main-content">Skip to main content</a>

  <!-- usa-header -->
  <div class="usa-overlay"></div>
  <header class="usa-header usa-header--basic">
    <div class="usa-nav-container">
      <div class="usa-navbar">
        <div class="usa-logo" id="-logo">
          <em class="usa-logo__text"
              ><a href="/" title="SBA Section 508 Dashboard">Section 508 Pro</a></em
          >
        </div>
        <button type="button" class="usa-menu-btn">Menu</button>
      </div>
      <nav aria-label="Primary navigation," class="usa-nav">
        <button type="button" class="usa-nav__close">
          <img src="/assets/uswds/img/usa-icons/close.svg" role="img" alt="Close" />
        </button>
        <ul class="usa-nav__primary usa-accordion">
          <li class="usa-nav__primary-item">
            <a href="/public.html" class="usa-nav-link"><span>Public Webpages</span></a>
          </li>
          <li class="usa-nav__primary-item">
            <a href="/internal.html" class="usa-nav-link"><span>Internal Webpages</span></a>
          </li>
          <li class="usa-nav__primary-item">
            <a href="/documents.html" class="usa-nav-link"><span>Public Documents</span></a>
          </li>
          <li class="usa-nav__primary-item">
            <a href="/assessment.html" class="usa-nav-link"><span>Full Assessment</span></a>
          </li>
        </ul>
        <section aria-label="Search component">
          <form class="usa-search usa-search--small" role="search">
            <label class="usa-sr-only" for="search-field">Search</label>
            <input
              class="usa-input"
              id="search-field"
              type="search"
              name="search"
            />
            <button class="usa-button" type="submit">
              <img
                src="/assets/uswds/img/usa-icons-bg/search--white.svg"
                class="usa-search__submit-icon"
                alt="Search"
              />
            </button>
          </form>
        </section>
      </nav>
    </div>
  </header>
  <!-- usa-header -->

  <!-- usa-section -->
  <div class="usa-section">
    <div class="grid-container-widescreen">
      <div class="grid-row grid-gap">

        <!-- sidebar navigation -->
        <div class="usa-layout-docs__sidenav desktop:grid-col-3">
          <nav aria-label="Secondary navigation">
            <ul class="usa-sidenav">
              <li class="usa-sidenav__item">
                <a href="public.html">Summary</a>
              </li>
              <li class="usa-sidenav__item">
                <a href="history.html">History</a>
              </li>
              <li class="usa-sidenav__item">
                <a href="agencies.html">Federal Agencies</a>
                <ul class="usa-sidenav__sublist">
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=cns" id="cns">CNS - Corporation for National and Community Service (Americorps)</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=dhs" id="dhs">DHS - Department of Homeland Security</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=doc" id="doc">DOC - Department of Commerce</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=doe" id="doe">DOE - Department of Energy</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=doi" id="doi">DOI - Department of the Interior</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=doj" id="doj">DOJ - Department of Justice</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=dol" id="dol">DOL - Department of Labor</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=dot" id="dot">DOT - Department of Transportation</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=ed" id="ed">ED - Department of Education</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=eeoc" id="eeoc">EEOC - Equal Employment Opportunity Commission </a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=epa" id="epa">EPA - Environmental Protection Agency</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=fcc" id="fcc">FCC - Federal Communications Commission</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=fdic" id="fdic">FDIC - Federal Deposit Insurance Corporation</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=gsa" id="gsa">GSA - General Services Administration</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=hhs" id="hhs">HHS - Deparment of Health and Human Services</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=hud" id="hud">HUD - Department of Housing and Urban Development</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=nara" id="nara">NARA - National Archives and Records Administration</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=ncua" id="ncua">NCUA - National Credit Union Administration</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=nrc" id="nrc">NRC - US Nuclear Regulatory Commission</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=nsf" id="nsf">NSF - National Science Foundation</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=opm" id="opm">OPM - Office of Personnel Management</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=pbgc" id="pbgc">PBGC - Pension Benefit Guaranty Corporation</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=sba" id="sba">SBA - Small Business Administration</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=sec" id="sec">SEC - Securities and Exchange Commission</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=ssa" id="ssa">SSA - Social Security Administration</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=state" id="state">State - Department of State</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=treasury" id="treasury">Treasury - Department of Treasury</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=usab" id="usab">USAB - US Access Board</a>
                  </li>
                  <li class="usa-sidenav__item">
                    <a href="view.html?website=usaid" id="usaid">USAID - US Agency of International Development</a>
                  </li>
                </ul>
              </li>
            </ul>
          </nav>
        </div>



        <main
          class="
            usa-layout-docs__main
            desktop:grid-col-9
            usa-prose usa-layout-docs
          "
          id="main-content"
        >
          <h1 id="main-header">View</h1>
          <p class="usa-intro">
          </p>

          <div class="grid-container">
            <div class="grid-row">
              <div class="tablet:grid-col">
                <h2>WCAG</h2>
                <wcag-form></wcag-form>
              </div>

              <div class="tablet:grid-col">
                <h2>Lighthouse</h2>
                <iframe src=""
                        id="lighthouse-html"
                        width="100%"
                        height="1000px"></iframe>
              </div>
            </div>
          </div>




        </main>
      </div>
    </div>
  </div>
  <footer class="usa-footer">
    <div class="grid-container usa-footer__return-to-top">
      <a href="#">Return to top</a>
    </div>

    <div class="usa-footer__secondary-section">
      <div class="grid-container">
        <div class="grid-row grid-gap">
          <div
            class="
              usa-footer__logo
              grid-row
              mobile-lg:grid-col-6 mobile-lg:grid-gap-2
            "
          >
            <div class="mobile-lg:grid-col-auto">
              <img
                class="usa-footer__logo-img"
                src="/assets/uswds/img/logo-img.png"
                alt=""
              />
            </div>
            <div class="mobile-lg:grid-col-auto">
              <p class="usa-footer__logo-heading">Skyward IT Solutions</p>
            </div>
          </div>
          <div class="usa-footer__contact-links mobile-lg:grid-col-6">
            <div class="usa-footer__social-links grid-row grid-gap-1">
              <div class="grid-col-auto">
                <a class="usa-social-link" href="javascript:void(0);"
                  ><img
                    class="usa-social-link__icon"
                    src="/assets/uswds/img/usa-icons/facebook.svg"
                    alt="Facebook"
                /></a>
              </div>
              <div class="grid-col-auto">
                <a class="usa-social-link" href="javascript:void(0);"
                  ><img
                    class="usa-social-link__icon"
                    src="/assets/uswds/img/usa-icons/twitter.svg"
                    alt="Twitter"
                /></a>
              </div>
              <div class="grid-col-auto">
                <a class="usa-social-link" href="javascript:void(0);"
                  ><img
                    class="usa-social-link__icon"
                    src="/assets/uswds/img/usa-icons/youtube.svg"
                    alt="YouTube"
                /></a>
              </div>
              <div class="grid-col-auto">
                <a class="usa-social-link" href="javascript:void(0);"
                  ><img
                    class="usa-social-link__icon"
                    src="/assets/uswds/img/usa-icons/instagram.svg"
                    alt="Instagram"
                /></a>
              </div>
              <div class="grid-col-auto">
                <a class="usa-social-link" href="javascript:void(0);"
                  ><img
                    class="usa-social-link__icon"
                    src="/assets/uswds/img/usa-icons/rss_feed.svg"
                    alt="RSS"
                /></a>
              </div>
            </div>
            <p class="usa-footer__contact-heading">
              Contact us
            </p>
            <address class="usa-footer__address">
              <div class="usa-footer__contact-info grid-row grid-gap">
                <div class="grid-col-auto">
                  <a href="tel:410-449-3003">(410) 449-3003</a>
                </div>
                <div class="grid-col-auto">
                  <a href="mailto:info@skywarditsolutions.com">info@skywarditsolutions.com</a>
                </div>
              </div>
            </address>
          </div>
        </div>
      </div>
    </div>
  </footer>

      <script src="assets/uswds/dist/js/uswds.min.js"></script>
  </body>
</html>
